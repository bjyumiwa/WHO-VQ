<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no" />
  <title>WHO VQ â€” Start</title>

  <!-- èƒŒæ™¯ç”»åƒã®å…ˆèª­ã¿ï¼ˆå¿…ãš public/items/bg/*.jpg ï¼‰ -->
  <link rel="preload" as="image" href="public/items/bg/sunrise.jpg" />
  <link rel="preload" as="image" href="public/items/bg/beach_day.jpg" />
  <link rel="preload" as="image" href="public/items/bg/night_beach.jpg" />

  <style>
    :root {
      --glass: rgba(255,255,255,.12);
      --glass-strong: rgba(255,255,255,.18);
      --text-shadow: 0 2px 8px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      font-family:system-ui,"Noto Sans JP","Hiragino Sans","Meiryo",sans-serif;
      color:#fff; background:#000 center/cover no-repeat fixed; overflow:hidden;
    }
    /* ç”»é¢å…¨ä½“ã®ã‚³ãƒ³ãƒ†ãƒŠ */
    #wrap{position:relative; inset:0; width:100%; height:100dvh;}
    /* ä¸Šãƒãƒ¼ï¼ˆè¨€èªãƒ»èƒŒæ™¯ãƒ©ãƒ™ãƒ«ï¼‰ */
    #topbar{
      position:fixed; left:0; right:0; top:0; z-index:10;
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px;
      background:linear-gradient(180deg,rgba(0,0,0,.55),rgba(0,0,0,0));
    }
    #bgLabel{
      font-size:12px; opacity:.9; padding:6px 10px; border-radius:10px;
      background:rgba(0,0,0,.35); box-shadow:var(--text-shadow);
    }
    /* è¨€èªã‚»ãƒ¬ã‚¯ã‚¿ */
    #langBox{
      display:flex; align-items:center; gap:6px;
      padding:6px 10px; border-radius:999px; background:var(--glass);
      backdrop-filter: blur(6px);
    }
    #langSelect{
      appearance:none; background:transparent; color:#fff; border:none; font-weight:600; cursor:pointer;
    }
    #langSelect:focus{ outline:2px solid rgba(255,255,255,.4); border-radius:6px; }

    /* ä¸­å¤®ã®ã‚¿ã‚¤ãƒˆãƒ« */
    main{
      position:absolute; inset:0; display:grid; place-items:center;
      padding:24px;
    }
    .center{
      text-align:center; max-width:min(90vw, 980px);
      text-shadow:var(--text-shadow);
    }
    h1{ font-size: clamp(28px, 5vw, 56px); margin:0 0 14px }
    p.lead{ font-size: clamp(14px, 2.2vw, 20px); margin:0 0 28px; opacity:.92 }

    /* ãƒœã‚¿ãƒ³ç¾¤ */
    .btns{ display:flex; gap:14px; justify-content:center; flex-wrap:wrap }
    a.btn, button.btn{
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 18px; border-radius:14px; border:none; cursor:pointer;
      background:var(--glass); color:#fff; font-weight:700; text-decoration:none;
      backdrop-filter: blur(6px); transition:transform .02s ease, background .2s ease;
      min-width:140px;
    }
    a.btn.primary, button.btn.primary{ background:#74c1e6cc }
    .btn:active{ transform:translateY(1px) }
    .btn:hover{ background:var(--glass-strong) }
    .btn.primary:hover{ filter:brightness(1.05) }

    /* ç”»é¢ä¸‹ã®ã‚³ãƒ”ãƒ¼ */
    footer{
      position:fixed; left:50%; bottom:10px; transform:translateX(-50%);
      font-size:12px; opacity:.88; background:rgba(0,0,0,.35);
      padding:6px 10px; border-radius:10px; backdrop-filter: blur(6px);
      text-shadow:var(--text-shadow);
    }
  </style>
</head>
<body>
  <div id="wrap" aria-label="start screen">
    <div id="topbar">
      <div id="bgLabel" data-i18n="bg.day">Day</div>
      <div id="langBox" aria-label="language">
        <span>ğŸŒ</span>
        <select id="langSelect" title="language">
          <option value="ja">æ—¥æœ¬èª</option>
          <option value="en">English</option>
          <option value="zh">ä¸­æ–‡</option>
          <option value="ko">í•œêµ­ì–´</option>
        </select>
      </div>
    </div>

    <main>
      <div class="center">
        <h1 data-i18n="title">WHO VQ</h1>
        <p class="lead" data-i18n="subtitle">ã‚ãªãŸã®ãŠä¸–è©±ãŒã€èª°ã‹ã®ä¸–ç•Œã«</p>
        <div class="btns">
          <a id="startBtn" class="btn primary" href="char.html" data-i18n="start">ã‚¹ã‚¿ãƒ¼ãƒˆ</a>
          <button id="resumeBtn" class="btn" data-i18n="resume">ç¶šãã‹ã‚‰</button>
          <a class="btn" href="about.html" data-i18n="about">ç ”ç©¶ã«ã¤ã„ã¦</a>
        </div>
      </div>
    </main>

    <footer id="phaseFoot" data-i18n="phase">èƒŒæ™¯ï¼šæ˜¼</footer>
  </div>

  <script>
    // ========= èƒŒæ™¯ï¼ˆæ™‚åˆ»ã§è‡ªå‹•ï¼‰ï¼†ãƒ•ã‚§ãƒ¼ã‚ºå =========
    function setBackgroundAndLabel(){
      const h = new Date().getHours();
      let phase = "day", bg = "public/items/bg/beach_day.jpg";
      if (h >= 5 && h <= 8){ phase = "sunrise"; bg = "public/items/bg/sunrise.jpg"; }
      else if (h >= 18 || h <= 4){ phase = "night"; bg = "public/items/bg/night_beach.jpg"; }
      document.body.style.backgroundImage = `url('${bg}')`;
      document.body.dataset.phase = phase;
      // ç¿»è¨³æ›´æ–°æ™‚ã«ãƒ©ãƒ™ãƒ«ã‚’å†è¨­å®šã™ã‚‹ãŸã‚ã€ã“ã“ã§ã¯ data-phase ã‚’ã ã‘
    }

    // ========= i18n ãƒ†ãƒ¼ãƒ–ãƒ« =========
    const I18N = {
      ja:{
        title:"WHO VQ",
        subtitle:"ã‚ãªãŸã®ãŠä¸–è©±ãŒã€èª°ã‹ã®ä¸–ç•Œã«",
        start:"ã‚¹ã‚¿ãƒ¼ãƒˆ",
        resume:"ç¶šãã‹ã‚‰",
        about:"ç ”ç©¶ã«ã¤ã„ã¦",
        phase:"èƒŒæ™¯ï¼š{label}",
        bg:{ sunrise:"æœæ—¥", day:"æ˜¼", night:"å¤œ" }
      },
      en:{
        title:"WHO VQ",
        subtitle:"Your care can shape someoneâ€™s world.",
        start:"Start",
        resume:"Continue",
        about:"About",
        phase:"Background: {label}",
        bg:{ sunrise:"Sunrise", day:"Day", night:"Night" }
      },
      zh:{
        title:"WHO VQ",
        subtitle:"ä½ çš„å…³æ€€ï¼Œè¿æ¥ç€ä»–äººçš„ä¸–ç•Œã€‚",
        start:"å¼€å§‹",
        resume:"ç»§ç»­",
        about:"å…³äºç ”ç©¶",
        phase:"èƒŒæ™¯ï¼š{label}",
        bg:{ sunrise:"æ—¥å‡º", day:"ç™½å¤©", night:"å¤œæ™š" }
      },
      ko:{
        title:"WHO VQ",
        subtitle:"ë‹¹ì‹ ì˜ ëŒë´„ì´ ëˆ„êµ°ê°€ì˜ ì„¸ê³„ë¥¼ ë§Œë“­ë‹ˆë‹¤.",
        start:"ì‹œì‘",
        resume:"ì´ì–´í•˜ê¸°",
        about:"ì—°êµ¬ ì†Œê°œ",
        phase:"ë°°ê²½: {label}",
        bg:{ sunrise:"ìƒˆë²½", day:"ë‚®", night:"ë°¤" }
      }
    };

    function getLang(){
      return localStorage.getItem("whoai_lang") || navigator.language.slice(0,2) || "ja";
    }
    function setLang(lang){
      localStorage.setItem("whoai_lang", lang);
      document.documentElement.setAttribute("lang", lang);
    }
    function applyI18n(){
      const lang = (getLang() in I18N) ? getLang() : "ja";
      const dict = I18N[lang];
      // ãƒ†ã‚­ã‚¹ãƒˆç½®æ›
      document.querySelectorAll("[data-i18n]").forEach(el=>{
        const key = el.getAttribute("data-i18n");
        const value = key.split(".").reduce((o,k)=> o && o[k], dict);
        if (typeof value === "string"){ el.textContent = value; }
      });
      // èƒŒæ™¯ãƒ©ãƒ™ãƒ«ï¼ˆãƒ•ã‚§ãƒ¼ã‚ºï¼‰
      const phase = document.body.dataset.phase || "day";
      const label = (dict.bg && dict.bg[phase]) ? dict.bg[phase] : phase;
      const foot = document.getElementById("phaseFoot");
      const bgLabel = document.getElementById("bgLabel");
      foot.textContent = (dict.phase || "èƒŒæ™¯ï¼š{label}").replace("{label}", label);
      bgLabel.textContent = label;
      // ã‚»ãƒ¬ã‚¯ã‚¿è¡¨ç¤ºè¨€èª
      const sel = document.getElementById("langSelect");
      sel.value = lang;
    }

    // ========= ç¶šãã‹ã‚‰ï¼ˆæœ€å¾Œã«é–‹ã„ãŸãƒšãƒ¼ã‚¸ï¼‰ =========
    function goResume(){
      const last = localStorage.getItem("whoai_lastPage");
      const allow = new Set(["index.html","char.html","asari.html","collection.html","accessory.html","night.html","about.html"]);
      const target = (last && allow.has(new URL(last, location.href).pathname.split("/").pop())) ? last : "char.html";
      location.href = target;
    }

    // ========= åˆæœŸåŒ– =========
    setBackgroundAndLabel();
    setLang(getLang());
    applyI18n();
    // è¨€èªã‚»ãƒ¬ã‚¯ã‚¿
    document.getElementById("langSelect").addEventListener("change", (e)=>{
      setLang(e.target.value); applyI18n();
    });
    // ãƒœã‚¿ãƒ³
    document.getElementById("resumeBtn").addEventListener("click", goResume);

    // ç¾åœ¨ãƒšãƒ¼ã‚¸ã‚’ä¿å­˜ï¼ˆæ¬¡å›ã®ã€Œç¶šãã‹ã‚‰ã€ç”¨ï¼‰
    localStorage.setItem("whoai_lastPage", "index.html");
  </script>
</body>
</html>
